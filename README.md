# Image OCR POC - åœ–ç‰‡OCRæ¸¬è©¦ç³»çµ±

ä¸€å€‹ç”¨æ–¼æ¸¬è©¦å’Œæ¯”è¼ƒä¸åŒOCRå¼•æ“æ•ˆèƒ½çš„å®Œæ•´ç³»çµ±ï¼ŒåŒ…å«åœ–ç‰‡ç”Ÿæˆæ¨¡å¡Šå’ŒOCRæ¸¬è©¦æ¨¡å¡Šã€‚

## åŠŸèƒ½ç‰¹é»

### åœ–ç‰‡ç”Ÿæˆæ¨¡å¡Š
- âœ… æ”¯æŒå¤šèªè¨€æ–‡å­—ç”Ÿæˆï¼ˆè‹±æ–‡ã€ä¸­æ–‡ã€æ—¥æ–‡ã€éŸ“æ–‡ï¼‰
- âœ… å¯èª¿æ•´å­—é«”å¤§å°ã€æ¨¡ç³Šç¨‹åº¦ã€å™ªé»ç­‰æ•ˆæœ
- âœ… è‡ªå‹•è¨˜éŒ„ç”Ÿæˆè¨­å®šï¼Œæ–¹ä¾¿å¾ŒçºŒåˆ†æ
- âœ… æ¨¡æ“¬çœŸå¯¦æ‹æ”ç’°å¢ƒçš„åœ–ç‰‡æ•ˆæœ

### OCRæ¸¬è©¦æ¨¡å¡Š
- âœ… æ’ä»¶åŒ–æ¶æ§‹ï¼Œæ–¹ä¾¿æ›¿æ›ä¸åŒçš„OCRå¼•æ“
- âœ… å…§å»ºTesseract OCRå¼•æ“æ”¯æŒ
- âœ… æ”¯æ´å¤šèªè¨€è¾¨è­˜ï¼šè‹±æ–‡ã€ä¸­æ–‡ï¼ˆç¹é«”å„ªå…ˆï¼‰ã€æ—¥æ–‡ã€éŸ“æ–‡
- âœ… ç¹é«”ä¸­æ–‡è¾¨è­˜æº–ç¢ºåº¦é«˜é”96%+
- âœ… æ–‡å­—åº§æ¨™å®šä½ï¼šç²å–æ¯å€‹æ–‡å­—å€åŸŸçš„ bounding box (x, y, width, height)
- âœ… è©³ç´°çš„æº–ç¢ºåº¦åˆ†æå’Œæ•ˆèƒ½è©•ä¼°
- âœ… æ‰¹é‡æ¸¬è©¦å’Œå ±å‘Šç”Ÿæˆ

## å®‰è£æ­¥é©Ÿ

### ç³»çµ±ä¾è³´
```bash
# æ›´æ–°ç³»çµ±
sudo apt update && sudo apt upgrade -y

# å®‰è£Tesseract OCR
sudo apt install tesseract-ocr

# å®‰è£èªè¨€åŒ…ï¼ˆæ¨è–¦å®‰è£æ¸¬è©¦èªè¨€ï¼‰
sudo apt install tesseract-ocr-eng tesseract-ocr-chi-sim tesseract-ocr-chi-tra tesseract-ocr-jpn tesseract-ocr-kor

# ğŸ” ä¸­æ–‡è¾¨è­˜èªªæ˜ï¼š
# - chi_sim: ç°¡é«”ä¸­æ–‡èªè¨€åŒ…
# - chi_tra: ç¹é«”ä¸­æ–‡èªè¨€åŒ… (é‡è¦ï¼ç³»çµ±å„ªå…ˆä½¿ç”¨ç¹é«”ä¸­æ–‡é€²è¡Œè¾¨è­˜)
# - ç³»çµ±ç¾åœ¨æ”¯æ´ç¹é«”ä¸­æ–‡è¾¨è­˜ï¼Œæä¾›æ›´å¥½çš„æº–ç¢ºåº¦ (å¯é”96%+)

# å®‰è£ä¸­æ–‡å­—é«”ï¼ˆç”¨æ–¼åœ–ç‰‡ç”Ÿæˆä¸­çš„ä¸­æ–‡å­—é¡¯ç¤ºï¼‰
sudo apt install fonts-noto-cjk fonts-noto-cjk-extra fonts-wqy-zenhei fonts-wqy-microhei fonts-arphic-ukai fonts-arphic-uming

# å®‰è£åœ–å½¢è™•ç†ä¾è³´ï¼ˆç”¨æ–¼ OpenCV xåœ–ç‰‡è™•ç†ï¼Œå¦‚å™ªé»ã€æ—‹è½‰ç­‰æ•ˆæœï¼‰
sudo apt install libgl1-mesa-glx libglib2.0-0 libsm6 libxext6 libxrender-dev libgomp1
```

### Pythonä¾è³´
```bash
# å®‰è£Pythonå¥—ä»¶
pip install -r requirements.txt
```

## å¿«é€Ÿé–‹å§‹

### ç”Ÿæˆæ¸¬è©¦åœ–ç‰‡ä¸¦é‹è¡ŒOCRæ¸¬è©¦
```bash
# ç”Ÿæˆ10å¼µæ¸¬è©¦åœ–ç‰‡ï¼ˆè‹±æ–‡å’Œä¸­æ–‡ï¼‰ï¼Œä½¿ç”¨Tesseracté€²è¡Œæ¸¬è©¦
python app/main.py --images 10 --languages english chinese

# ä½¿ç”¨ç¾æœ‰çš„æ¸¬è©¦åœ–ç‰‡é€²è¡Œæ¸¬è©¦
python app/main.py --no-generate

# æŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„OCRå¼•æ“
python app/main.py --list-engines
```

#### æ¸¬è©¦ä»»æ„åœ–ç‰‡ï¼ˆæ¨è–¦ç”¨æ³•ï¼‰
```bash
# æ¸¬è©¦é è¨­çš„æ¸¬è©¦åœ–ç‰‡ï¼ˆæœƒé€²è¡Œæº–ç¢ºåº¦æ¯”å°ï¼‰
python demo.py

# è‡ªå®šç¾©æ¸¬è©¦è³‡æ–™å¤¾
# å¦‚æœè³‡æ–™å¤¾ä¸­æœ‰ config æª”æ¡ˆï¼Œå°‡é€²è¡Œæº–ç¢ºåº¦æ¯”å°ï¼›å¦‚æœæ²’æœ‰ï¼Œåªé¡¯ç¤ºOCRçµæœ
# ä¿®æ”¹ demo.py ä¸­çš„ TEST_FOLDER åƒæ•¸ä¾†è‡ªå®šç¾©æ¸¬è©¦è³‡æ–™å¤¾ï¼š
# TEST_FOLDER = "your_custom_folder"  # è¨­å®šæ¸¬è©¦è³‡æ–™å¤¾è·¯å¾‘
# TEST_FOLDER = "path/to/image.jpg"   # æˆ–æŒ‡å®šå–®å€‹åœ–ç‰‡æª”æ¡ˆ
# TEST_FOLDER = ""                    # éŒ¯èª¤ï¼šä¸èƒ½ç‚ºç©º

# ç”Ÿæˆæ–°æ¸¬è©¦åœ–ç‰‡
python generate_images.py
```

**é€²éšé¸é …:**
- `--recursive, -r`: éæ­¸æƒæå­è³‡æ–™å¤¾
- `--max-files, -m`: é™åˆ¶è™•ç†çš„æœ€å¤§æª”æ¡ˆæ•¸é‡

**æ”¯æ´çš„èªè¨€:**
- `english` - è‹±æ–‡
- `chinese` - ä¸­æ–‡ï¼ˆå„ªå…ˆç¹é«”ä¸­æ–‡è¾¨è­˜ï¼Œæ”¯æ´ç°¡é«”ä¸­æ–‡ï¼‰
- `japanese` - æ—¥æ–‡
- `korean` - éŸ“æ–‡
- `auto` - è‡ªå‹•å¤šèªè¨€æª¢æ¸¬ï¼ˆè‹±æ–‡+ç¹é«”+ç°¡é«”ä¸­æ–‡ï¼‰

**ä¸­æ–‡è¾¨è­˜ç‰¹é»:**
- å„ªå…ˆä½¿ç”¨ç¹é«”ä¸­æ–‡æ¨¡å‹ï¼Œæä¾›æ›´å¥½çš„æº–ç¢ºåº¦
- è‡ªå‹•æ”¯æ´ç¹é«”å’Œç°¡é«”ä¸­æ–‡æ··åˆå…§å®¹
- è¾¨è­˜çµæœä¿æŒåŸå§‹æ–‡å­—å½¢å¼ï¼ˆç¹é«”è¼¸å‡ºç¹é«”ï¼Œç°¡é«”è¼¸å‡ºç°¡é«”ï¼‰

**æ–‡å­—åº§æ¨™å®šä½:**
- æ¯å€‹æ–‡å­—å€åŸŸçš„bounding boxè³‡è¨Šï¼šx, y, width, height
- é©ç”¨æ–¼æ–‡å­—å®šä½ã€å€åŸŸæå–ç­‰é€²éšæ‡‰ç”¨
- å¯åœ¨demo.pyä¸­è¨­å®š`SHOW_BOUNDING_BOXES = True/False`ä¾†æ§åˆ¶é¡¯ç¤º

**æ”¯æ´çš„åœ–ç‰‡æ ¼å¼:**
PNG, JPG, JPEG, BMP, TIFF, WebP, GIFç­‰å¸¸è¦‹æ ¼å¼

### é€²éšç”¨æ³•

```bash
# ç”Ÿæˆæ›´å¤šåœ–ç‰‡æ¸¬è©¦æ—¥æ–‡å’ŒéŸ“æ–‡
python app/main.py --images 20 --languages japanese korean

# æŒ‡å®šä½¿ç”¨ç‰¹å®šOCRå¼•æ“
python app/main.py --engine tesseract --no-generate

# è‡ªå®šç¾©æ¸¬è©¦åƒæ•¸
python app/main.py --images 50 --languages english chinese japanese korean
```

## å°ˆæ¡ˆçµæ§‹

```
image-ocr-poc/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py                    # ä¸»ç¨‹å¼å…¥å£
â”‚   â”œâ”€â”€ test_runner.py            # æ¸¬è©¦é‹è¡Œå™¨
â”‚   â”œâ”€â”€ image_generator/          # åœ–ç‰‡ç”Ÿæˆæ¨¡å¡Š
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ image_generator.py    # åœ–ç‰‡ç”Ÿæˆå™¨å¯¦ä½œ
â”‚   â””â”€â”€ ocr_engine/               # OCRå¼•æ“æ¨¡å¡Š
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ base_ocr.py           # OCRå¼•æ“æŠ½è±¡æ¥å£
â”‚       â”œâ”€â”€ tesseract_ocr.py      # Tesseractå¯¦ä½œ
â”‚       â””â”€â”€ ocr_manager.py        # å¼•æ“ç®¡ç†å™¨
â”œâ”€â”€ _testing_images/              # æ¸¬è©¦æª”æ¡ˆå­˜æ”¾å€
â”‚   â”œâ”€â”€ images/                   # ç”Ÿæˆçš„æ¸¬è©¦åœ–ç‰‡
â”‚   â”œâ”€â”€ configs/                  # åœ–ç‰‡è¨­å®šæª”æ¡ˆ
â”‚   â”œâ”€â”€ reports/                  # æ¸¬è©¦å ±å‘Š
â”‚   â””â”€â”€ README.md                 # å­˜æ”¾å€èªªæ˜
â”œâ”€â”€ requirements.txt              # Pythonä¾è³´
â””â”€â”€ README.md                     # å°ˆæ¡ˆèªªæ˜
```

## æ¸¬è©¦çµæœåˆ†æ

æ¸¬è©¦å®Œæˆå¾Œæœƒè‡ªå‹•ç”Ÿæˆè©³ç´°çš„JSONå ±å‘Šï¼ŒåŒ…å«ï¼š

- **æº–ç¢ºåº¦çµ±è¨ˆ**: å„èªè¨€ã€å„æ•ˆæœä¸‹çš„è­˜åˆ¥æº–ç¢ºåº¦
- **æ•ˆèƒ½åˆ†æ**: OCRå¼•æ“çš„è™•ç†æ™‚é–“å’Œä¿¡å¿ƒåº¦
- **æ–‡å­—åº§æ¨™**: æ¯å€‹æ–‡å­—å€åŸŸçš„bounding box (x, y, width, height)
- **åœ–ç‰‡è³‡è¨Š**: æª”æ¡ˆå°ºå¯¸ã€æ ¼å¼ç­‰å…ƒè³‡æ–™
- **ç¸½çµå ±å‘Š**: æ•´é«”æ¸¬è©¦çµ±è¨ˆå’Œæ•ˆèƒ½åˆ†æ

### çµæœå„²å­˜çµæ§‹

```
_results/
â”œâ”€â”€ result_[timestamp]_[filename].json    # æ¯å€‹åœ–ç‰‡çš„è©³ç´°çµæœ
â”œâ”€â”€ summary_[timestamp].json              # æ•´é«”æ¸¬è©¦ç¸½çµ
â””â”€â”€ README.md                             # è³‡æ–™å¤¾èªªæ˜
```

**æ³¨æ„**: `_results` è³‡æ–™å¤¾æœƒåœ¨æ¯æ¬¡åŸ·è¡Œ `demo.py` å‰è‡ªå‹•æ¸…ç©º

## æ“´å±•OCRå¼•æ“

ç³»çµ±æ¡ç”¨æ’ä»¶åŒ–è¨­è¨ˆï¼Œè¦æ·»åŠ æ–°çš„OCRå¼•æ“ï¼š

1. å‰µå»ºæ–°çš„å¼•æ“é¡ï¼Œç¹¼æ‰¿ `BaseOCREngine`
2. åœ¨ `ocr_manager.py` ä¸­è¨»å†Šæ–°å¼•æ“
3. æˆ–ä½¿ç”¨ `OCREngineManager.load_external_engine()` å‹•æ…‹è¼‰å…¥

```python
from app.ocr_engine.base_ocr import BaseOCREngine
from app.ocr_engine.ocr_manager import ocr_manager

class MyCustomOCREngine(BaseOCREngine):
    # å¯¦ä½œå¿…è¦çš„æ–¹æ³•...

# è¨»å†Šå¼•æ“
ocr_manager.register_engine('my_engine', MyCustomOCREngine)
```

## å¸¸è¦‹å•é¡Œ

### Q: ç”Ÿæˆå‡ºä¾†çš„ä¸­æ–‡å­—éƒ½è®Šæˆæ¡†æ¡†ç„¡æ³•é¡¯ç¤ºï¼Ÿ
A: é€™æ˜¯å› ç‚ºç³»çµ±ç¼ºå°‘ä¸­æ–‡å­—é«”ã€‚è«‹ç¢ºä¿å®‰è£äº†ä¸­æ–‡å­—é«”åŒ…ï¼š
```bash
sudo apt install fonts-noto-cjk fonts-noto-cjk-extra fonts-wqy-zenhei fonts-wqy-microhei fonts-arphic-ukai fonts-arphic-uming
```
å®‰è£å¾Œé‡æ–°é‹è¡Œç¨‹å¼å³å¯ã€‚

### Q: Tesseractè­˜åˆ¥æ•ˆæœä¸ä½³ï¼Ÿ
A: æª¢æŸ¥æ˜¯å¦å®‰è£äº†å°æ‡‰èªè¨€åŒ…ï¼Œä¸¦å˜—è©¦èª¿æ•´ `--oem` å’Œ `--psm` åƒæ•¸ã€‚

### Q: å¦‚ä½•æ¸…ç†æ¸¬è©¦æª”æ¡ˆï¼Ÿ
A: åˆªé™¤ `_testing_images/images/` å’Œ `_testing_images/configs/` ä¸­çš„æª”æ¡ˆï¼Œå ±å‘Šæª”æ¡ˆå¯ä¿ç•™ç”¨æ–¼åˆ†æã€‚

## é–‹ç™¼èˆ‡è²¢ç»

æ­¡è¿æäº¤Issueå’ŒPull Requestï¼

## æˆæ¬Š

æœ¬å°ˆæ¡ˆæ¡ç”¨ Apache License 2.0 æˆæ¬Šã€‚
